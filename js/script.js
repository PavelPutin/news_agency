$(function(){const KEYS={37:1,38:1,39:1,40:1};const RATES={'USD':$('.rates__rate_dollar'),'EUR':$('.rates__rate_euro')};const WEEK_DAYS={'fullFormate':['воскресенье','понедельник','вторник','среда','четверг','пятница','суббота'],'shortFormate':['ВС','ПН','ВТ','СР','ЧТ','ПТ','СБ']};const MONTHS=['январь','февраль','март','апрель','май','июнь','июль','август','сентябрь','октябрь','ноябрь','декабрь',];const HEADER_DATETIME=$('.header__datetime');const HEADER_DATETIME_DATE=$('.header-datetime__date');const HEADER_DATETIME_DATE_MOBILE=$('.header__bottom_mobile .header-datetime__date');const HEADER_DATETIME_TIME=$('.header-datetime__time');const HEADER_DATETIME_ELEMENTS=$('.header [datetime]');const HEADER_NAV=$('.header__nav');const POPUP_WRAPPER=$('.popup__wrapper');const POPUP=$('.popup');for(let rate in RATES){setRate(rate,RATES[rate]);};$('.article__comments').each(function(){if($(this).text()>999){$(this).text('999+');}});setDateTimeValues(new Date());setInterval(function(){setDateTimeValues(new Date());},1000);$('.header__nav-button').click(function(){HEADER_NAV.slideToggle(function(){toggleScroll(HEADER_NAV);});setAriaLabelText($(this),'меню навигации по сайту')});$('.search-form__button_toggle').click(function(){$('.search-form').slideToggle();setAriaLabelText($(this),'форму поиска на сайте')});setTimeout(showPopup,3000);$('.header__link').click(showPopup);POPUP_WRAPPER.click(function(event){if(event.target==this){hidePopup();}});function setAriaLabelText(element,text){element.toggleClass('active');let ariaLabelText=(element.is('.active'))?`Закрыть ${text}`:`Открыть ${text}`;element.attr('aria-label',ariaLabelText);}function getWeekDay(time,formate){let weekDayCode=time.getDay();return WEEK_DAYS[formate][weekDayCode];}function getMonth(time,formate){let monthCode=time.getMonth();switch(formate){case'numeric':return formateNumericData(monthCode+1);case'string':return MONTHS[monthCode];}}function getHours(date){return formateNumericData(date.getHours());}function getMinutes(time){return formateNumericData(time.getMinutes());}function formateNumericData(data){data=String(data);return(data.length===1)?('0'+data):data;}function setDateTimeValues(time){let date=time.getDate();let monthString=getMonth(time,'string');let monthNumeric=getMonth(time,'numeric');let year=time.getFullYear();let timeString=`${getHours(time)}:${getMinutes(time)}`;let datetimeString=`${date} ${monthString}, ${getWeekDay(time, 'fullFormate')}`;let datetimeStringMobile=`${date} ${monthString}, ${getWeekDay(time, 'shortFormate')}`;let datetimeFullNumeric=`${date}.${monthNumeric}.${year}`;let datetimeAttrSting=`${year}-${monthNumeric}-${date}T${timeString}`;HEADER_DATETIME.text(`${timeString} ${datetimeFullNumeric}`);HEADER_DATETIME_TIME.text(timeString);HEADER_DATETIME_DATE.text(datetimeString);HEADER_DATETIME_DATE_MOBILE.text(datetimeStringMobile);HEADER_DATETIME_ELEMENTS.each(function(){$(this).attr('datetime',datetimeAttrSting);});}function showPopup(){POPUP_WRAPPER.fadeIn(500,disableScroll);POPUP.animate({'width':'100%','font-size':'16px'},500);}function hidePopup(){POPUP_WRAPPER.fadeOut(300,enableScroll);POPUP.animate({'width':'0','font-size':'0'},300);}function preventDefault(e){e=e||window.event;if(e.preventDefault){e.preventDefault();}e.returnValue=false;}function preventDefaultForScrollKeys(e){if(KEYS[e.keyCode]){preventDefault(e);return false;}}let eventOption=Modernizr.passiveeventlisteners?{passive:false}:false;function disableScroll(){if(window.addEventListener){window.addEventListener('DOMMouseScroll',preventDefault,false);}window.addEventListener('wheel',preventDefault,eventOption);document.addEventListener('mousewheel',preventDefault,eventOption);window.addEventListener('mousewheel',preventDefault,eventOption);window.addEventListener('touchmove',preventDefault,eventOption);document.onkeydown=preventDefaultForScrollKeys;}function enableScroll(){if(window.removeEventListener){window.removeEventListener('DOMMouseScroll',preventDefault,false);}window.removeEventListener('wheel',preventDefault,false);document.removeEventListener('mousewheel',preventDefault,false);window.removeEventListener('mousewheel',preventDefault,false);window.removeEventListener('touchmove',preventDefault,false);document.onkeydown=null;}function setRate(base,element){$.get(`https://api.exchangeratesapi.io/latest?base=${base}`,function(responce){let values=String(responce.rates.RUB).split('.');element.find('.rates__int').text(values[0]);element.find('.rates__fraction').text(values[1].substr(0,3));});};function toggleScroll(element){if(element.is(':visible')){disableScroll();}else{enableScroll();}}});